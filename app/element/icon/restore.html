
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animation.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../file-upload/file-upload.html">

<dom-module id="element-restore-icon">
  <template>
    <style>
      paper-dialog {

        margin: 0;
      }

      .container{
        width: 150px;
        margin-top: 12px;
        margin-bottom: 12px;
        padding: 0 12px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      paper-button {
        min-width: 100px;
      }

    </style>
    <paper-icon-button id="restore" icon="app:restore" title="{{label}}" on-tap="open"></paper-icon-button>
    <paper-dialog id="restoreDialog" no-overlap horizontal-align="center" vertical-align="top" entry-animation="fade-in-animation" exit-animation="fade-out-animation">
      <div class="container">
        <file-upload id="restoreFile"></file-upload>
        <paper-button on-tap="restore">Import</paper-button>
      </div>
    </paper-dialog>
  </template>

  <script>
      class ElementRestoreIcon extends Polymer.Element {

          static get is() { return 'element-restore-icon'; }

          static get properties() {
              return {
                  label : {
                      type: String,
                      value: 'Restore data'
                  }
              }
          }

          ready() {
              super.ready();
          }

          /**
           * @param evt
           */
          open(evt) {
              this.$.restoreDialog.open();
          }

          /**
           * @param evt
           */
          restore(evt) {

              if (!this.$.restoreFile.files[0]) {
                return;
              }

              serviceManager.get('Backup').restore(this.$.restoreFile.files[0].path);
              this.$.restoreFile.reset();
              this.$.restoreDialog.close();
          }
      }

      window.customElements.define(ElementRestoreIcon.is, ElementRestoreIcon);
  </script>
</dom-module>
